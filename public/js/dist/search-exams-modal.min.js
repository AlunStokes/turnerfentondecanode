function switchUnlock(a,e){$.ajax({type:"POST",url:"ajax",data:{ajaxid:"switchExamLock",examid:a}}).done(function(a){e(a.err?a.err:null)})}function loadExams(a,e,t,s){$.ajax({type:"GET",url:"ajax",data:{ajaxid:"searchExams",cluster:a,search:e,offset:t,examsPer:examsPer}}).done(function(a){a.err?notify("Server error - try again later","danger","exclamation"):(examsLoaded+=a.length,loadedExams=loadedExams.concat(a),s(a))})}function addExams(a){$("#load-more-exams")&&$("#load-more-exams").remove();var e="";0==a.length?e='<h1 class="text small thin dark">no more results</h1>':(e+=generateExamsHTML(a),e+='<button class="btn btn-lg btn-block active-color" id="load-more-exams">Load more</button>'),examsArea.append(e)}function replaceExams(a){examsLoaded=examsPer;var e="";0==a.length?e='<h1 class="text small thin dark">0 results returned</h1>':(e+=generateExamsHTML(a),e+='<button class="btn btn-lg btn-block active-color" id="load-more-exams">Load more</button>'),examsArea.html(e)}function generateExamHTML(a){var e="";return e+='<div class="row exam">',admin?(e+='<div class="row"><div class="col-xs-6 col-lg-6"><h3 class="truncate text thin dark small left">'+a.name+'</h3><p class="text thin dark xsmall left">'+a.cluster+'</p><p class="text thin dark xsmall left">'+a.numQuestions+" Questions</p></div>",a.unlocked?e+='<div class="col-xs-6 col-lg-6" style="text-align: right;"><label class="switch"><input type="checkbox" class="slider" id="unlocked-exam-'+a.id+'" checked><div class="slider round"></div></label><i><p id="lock-text-'+a.id+'">Unlocked</p></i></div></div>':e+='<div class="col-xs-6 col-lg-6" style="text-align: right;"><label class="switch"><input type="checkbox" class="slider" id="locked-exam-'+a.id+'"><div class="slider round"></div></label><i><p id="lock-text-'+a.id+'">Locked</p></i></div></div>',a.showScore?e+='<div class="row"><div class="col-xs-6 col-lg-6"></div>':e+='<div class="row"><div class="col-xs-6 col-lg-6"><p class="text thin dark xsmall italic">Score will not be shown</p></div>',e+='<div class="col-xs-6 col-lg-6"><form method="POST" action="exam"><button class="btn btn-start-exam active-color" style="float:right" id="start-exam-'+a.id+'"> Start Exam </button><input type="hidden" name="examid" value="'+a.id+'" /></form></div></div></div><hr width="60%"></hr>'):(e+='<div class="row"><div class="col-xs-6 col-lg-6"><h3 class="truncate text thin dark small left">'+a.name+'</h3><p class="text thin dark xsmall left">'+a.cluster+'</p><p class="text thin dark xsmall left">'+a.numQuestions+" Questions</p></div></div>",a.showScore?e+='<div class="row"><div class="col-xs-6 col-lg-6"></div>':e+='<div class="row"><div class="col-xs-6 col-lg-6"><p class="text thin dark xsmall italic">Score will not be shown</p></div>',e+='<div class="col-xs-6 col-lg-6">',a.unlocked?e+='<form method="POST" action="exam"><button class="btn btn-start-exam active-color" style="float:right" id="start-exam-'+a.id+'"> Start Exam </button><input type="hidden" name="examid" value="'+a.id+'" /></form>':e+='<button class="btn btn-start-exam active-color" style="float:right" id="start-exam-'+a.id+'" disabled> Start Exam </button>',e+='</div></div></div></div><hr width="60%"></hr>'),e}function generateExamsHTML(a){for(var e="",t=0;t<a.length;t++)e+=generateExamHTML(a[t]);return e}var examsSearch="",examsCluster="mix",examsPer=25,examsLoaded=0,loadedExams=[],examsSeachInput,examsClusterInput,examsArea;$(document).ready(function(){examsSeachInput=$("#exams-search-input"),examsClusterInput=$("#exam-cluster-input"),examsArea=$("#exams-area"),loadExams(examsCluster,examsSearch,examsLoaded,function(a){addExams(a)}),$(document).on("click","#load-more-exams",function(){loadExams(examsCluster,examsSearch,examsLoaded,function(a){addExams(a)})}),examsSeachInput.on("keyup",function(){examsSearch=examsSeachInput.val(),loadExams(examsCluster,examsSearch,examsLoaded=0,function(a){replaceExams(a)})}),examsClusterInput.on("change",function(){loadExams(examsCluster=examsClusterInput.val(),examsSearch,examsLoaded=0,function(a){replaceExams(a)})}),$(document).on("click",".btn-start-exam",function(){getNum(this.id)}),$(document).on("change",".slider",function(){var a=getNum(this.id);switchUnlock(a,function(e){e?notify(e,"danger","exclamation"):"Locked"==$("#lock-text-"+a).text()?$("#lock-text-"+a).text("Unlocked"):$("#lock-text-"+a).text("Locked")})})});