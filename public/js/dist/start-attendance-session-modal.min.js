function prepStartModal(t){checkSession(function(n,o){n?notify(n,"danger","exclamation"):(o&&(optionAInput.attr("disabled",!0),optionBInput.attr("disabled",!0),optionCInput.attr("disabled",!0),optionDInput.attr("disabled",!0),answerInput.attr("disabled",!0),confirmStartBtn.attr("disabled",!0),startInstructions.before("<h1 class='text thin medium center red'>Session already in progress - you may not start another</h1>")),t())})}function getSessionData(t){t({optionA:optionAInput.val(),optionB:optionBInput.val(),optionC:optionCInput.val(),optionD:optionDInput.val(),answer:answerInput.val()})}function checkSession(t){$.ajax({type:"GET",url:"ajax",data:{ajaxid:"getAttendanceSession"}}).done(function(n){n.err?t(n.err):t(null,n.currentSession)})}function validateSessionData(t,n){var o=/\`|\~|\!|\@|\#|\$|\%|\^|\&|\*|\(|\)|\+|\=|\[|\{|\]|\}|\||\\|\'|\<|\,|\.|\>|\?|\/|\""|\;|\:/g;for(var i in t){if(void 0===t[i]||0==t[i].length)return void n("All fields must be filled");if(t[i].indexOf(" ")>=0)return void n("No spaces are allowed - single words only");if(t[i].length>10)return void n("No more than 10 characters may be used per option");if(o.test(t[i]))return void n("No special chatacters allowed")}n(hasDuplicates([t.optionA,t.optionB,t.optionC,t.optionD])?"No two options may be the same":null)}function submitSessionData(t,n){$.ajax({type:"POST",url:"ajax",data:{ajaxid:"startAttendanceSession",sessionData:JSON.stringify(t)}}).done(function(t){n(t.err?t.err:null)})}function resetForm(){optionAInput.val(""),optionBInput.val(""),optionCInput.val(""),optionDInput.val(""),answerInput.val("A")}function hasDuplicates(t){for(var n=t.sort(),o=0;o<n.length;o++)if(n.indexOf(n[o])!==n.lastIndexOf(n[o]))return!0;return!1}var optionAInput,optionBInput,optionCInput,optionDInput,answerInput,confirmStartBtn,startInstructions,optionA,optionB,optionC,optionD,answer;$(document).ready(function(){optionAInput=$("#option-input-A"),optionBInput=$("#option-input-B"),optionCInput=$("#option-input-C"),optionDInput=$("#option-input-D"),answerInput=$("#answer-input"),confirmStartBtn=$("#confirm-start-session-btn"),startInstructions=$("#start-instructions"),confirmStartBtn.on("click",function(){getSessionData(function(t){validateSessionData(t,function(n){n?notify(n,"warning","exclamation"):submitSessionData(t,function(t){t?notify(t,"danger","exclamation"):(notify("Session successfully started","success","check"),resetForm())})})})})});